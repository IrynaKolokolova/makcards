<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <!-- Запрещаем масштабирование -->
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <title>Дзеркало душі — Односторінковий додаток</title>
  
  <!-- Шрифты -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Allura&display=swap" rel="stylesheet">

  <style>
    /* Общие стили */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      overflow-x: hidden;
      overflow-y: auto;
    }
    body {
      font-family: 'Allura', cursive;
      background: linear-gradient(135deg, #12122b, #232342);
      color: #fff;
      height: 100vh;
      position: relative;
      font-size: 1.3rem;
      line-height: 1.3;
    }
    
    .btn, .content, .deck-icons, .icon-btn {
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .fade-in.show, .fade-in.fade-in {
      opacity: 1;
      transform: translateY(0);
    }
    
    body, h1, h2, h3, h4, h5, h6, p, li, a, button, .btn, .highlight {
      text-shadow: 2px 2px 4px rgba(0,0,0,1);
    }
    
    /* Preloader */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #1e1e2f;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      transition: opacity 0.3s ease;
    }
    .spinner {
      border: 4px solid rgba(64,224,208,0.2);
      border-top: 4px solid rgba(64,224,208,0.8);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Анимированное название */
    .glowing-title {
      font-family: 'Great Vibes', cursive;
      font-size: 3rem;
      font-weight: bold;
      color: #fff;
      margin-top: -10px;
      margin-bottom: 10px;
      animation: glow 2s ease-in-out infinite alternate;
      text-align: center;
    }
    @keyframes glow {
      from {
        text-shadow: 0 0 2px rgba(255,255,255,0.3), 0 0 4px rgba(255,255,255,0.3);
      }
      to {
        text-shadow: 0 0 3px rgba(255,255,255,0.4), 0 0 5px rgba(255,255,255,0.4);
      }
    }
    
    .highlight {
      color: #fff;
      text-shadow: 0 0 6px rgba(255,255,255,0.8);
    }
    
    /* Главное меню */
    .menu {
      display: flex;
      flex-direction: column;
      gap: 20px;
      justify-content: flex-start; 
      align-items: center;
      height: 100vh;
      text-align: center;
      position: relative;
      z-index: 2;
      max-width: 90%;
      margin: 0 auto;
      padding: 60px 10px 10px;
    }
    
    .greeting p {
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 1.2rem;
      line-height: 1.3;
      max-width: 100%;
      text-align: justify;
      margin-bottom: 10px;
      margin-top: 20px;
    }
    
    .btn {
      font-family: 'Great Vibes', cursive;
      font-size: 1.8rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      cursor: pointer;
      color: #fff;
      text-align: center;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
      padding: 15px 30px;
      position: relative;
      overflow: hidden;
    }
    .btn:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 6px rgba(64,224,208,0.6);
    }
    .btn:active {
      transform: scale(0.95);
    }
    .btn::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(64,224,208,0.5), transparent 70%);
      opacity: 0;
      animation: buttonGlow 2.5s infinite;
      z-index: -1;
    }
    @keyframes buttonGlow {
      0% { opacity: 0; }
      50% { opacity: 0.5; }
      100% { opacity: 0; }
    }
    
    .btn.back-btn, .btn.continue-btn, .btn.sound-btn {
      padding: 4px 10px;
      min-width: auto;
      width: auto;
      height: auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .btn.back-btn img, .btn.continue-btn img, .btn.sound-btn img {
      width: 16px;
      height: 16px;
      filter: brightness(0) invert(1);
    }
    .btn.back-btn img {
      transform: rotate(180deg);
    }
    .btn.continue-btn img {
      transform: scaleY(-1);
    }
    .btn.shuffle-btn {
      padding: 4px 10px;
      min-width: auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .btn.shuffle-btn img {
      filter: brightness(0) invert(1);
      width: 17px;
      height: 17px;
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 10px;
    }
    
    .center-text {
      font-family: Georgia, serif;
      font-size: 1rem;
      font-style: italic;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,1);
      display: block !important;
      width: 100%;
      text-align: center;
      margin: 10px 0;
    }

    .deck-icons {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-top: 15px;
    }
    .icon-btn {
      width: 50px;
      height: 50px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      cursor: pointer;
      transition: opacity 0.5s ease, transform 0.5s ease, box-shadow 0.5s ease;
    }
    .icon-btn:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 8px rgba(64,224,208,0.7);
    }
    .icon-btn:active {
      transform: scale(0.95);
    }
    .icon-btn img {
      width: 30px;
      height: 30px;
      filter: brightness(0) invert(1);
    }
    
    .social-left {
      position: fixed;
      top: 10px;
      left: 10px;
      display: flex;
      gap: 15px;
      z-index: 11000;
    }
    .social-right {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 11000;
    }
    .social-left a, .social-right a {
      outline: none;
      border: none;
      background: none;
    }
    .social-left img, .social-right img {
      width: 20px;
      height: 20px; 
      filter: brightness(0) invert(1);
    }
    
    .section {
      display: none;
      padding: 10px;
      z-index: 2;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch;
    }
    #sectionDiary {
      overflow-y: auto !important;
    }
    .section.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    
    .content {
      max-width: 90%;
      margin: 30px auto 0 auto;
      font-size: 1.6rem;
      line-height: 1.5;
      text-align: justify;
      color: #fff;
      padding: 0 20px;
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    #sectionDiary .content {
      max-width: 100%;
      padding: 20px;
    }
    
    .how-it-works-text p,
    .how-it-works-text ul,
    .how-it-works-text ol {
      margin-bottom: 15px;
    }
    .how-it-works-text {
      padding: 15px;
      text-align: justify;
      font-size: 1.2rem;
      font-family: Georgia, serif;
      font-style: italic;
      text-shadow: none;
    }
    
    #sectionDeckInfo {
      overflow: hidden;
    }
    #sectionDeckInfo .content {
      max-width: 90%;
      margin: 40px auto 0 auto;
      font-size: 1.6rem;
      line-height: 1.5;
      text-align: justify;
      color: #fff;
      padding: 0 20px;
    }
    #sectionDeckInfo .content li,
    #sectionDeckInfo .content p,
    #sectionDeckInfo .content ol {
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 1.2rem;
      line-height: 1.3;
      text-shadow: none;
      text-align: justify;
    }
    
    #sectionMakKarti {
      overflow: hidden;
    }
    #sectionMakKarti .content {
      max-width: 90%;
      margin: -5px auto 0 auto;
      font-size: 1.6rem;
      line-height: 1.5;
      text-align: center;
      position: relative;
      padding: 10px;
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(4, 80px);
      grid-auto-rows: 112px;
      gap: 10px;
      justify-content: center;
      align-items: start;
      max-width: 600px;
      margin: 0 auto;
    }
    .card-container {
      width: 80px;
      height: 112px;
      perspective: 1000px;
      position: relative;
      opacity: 0;
      transition: opacity 6s ease, transform 6s ease;
    }
    .card-container.fade-in {
      opacity: 1;
      transform: none;
    }
    .small-card {
      width: 100%;
      height: 100%;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      border: 1px solid rgba(64,224,208,0.6);
      box-shadow: 0 0 10px rgba(64,224,208,0.3);
      transition: transform 0.2s;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    .small-card:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px rgba(64,224,208,0.6);
    }
    .small-card:active {
      transform: scale(0.95);
      box-shadow: 0 0 12px rgba(64,224,208,0.6);
    }
    .small-card.flipped {
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    #section72Cards {
      overflow-y: auto;
    }
    #section72Cards .content {
      padding: 10px;
      margin-top: -5px;
    }
    .cards-grid-72 {
      display: grid;
      grid-template-columns: repeat(4, 60px) !important;
      grid-auto-rows: 95px;
      gap: 30px;
      justify-content: center;
      align-items: start;
      max-width: calc(60px * 5 + 10px * 4) !important;
      margin: 0 auto;
      margin-left: -2px;
    }
    #section72Cards .card-container {
      width: 60px;
      height: 84px;
      perspective: 1000px;
      position: relative;
    }
    
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .overlay.active {
      display: flex;
      opacity: 1;
    }
    @keyframes zoomIn {
      0% { opacity: 0; transform: translateY(20px) scale(0.8); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    .overlay-card-container {
      position: relative;
      width: 320px;
      height: 448px;
      perspective: 2000px;
      transform: translateY(20px) scale(0.8);
      animation: zoomIn 3s forwards ease;
    }
    .big-card {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      border-radius: 12px;
      transition: transform 0.8s cubic-bezier(0.4, 0.2, 0.2, 1);
    }
    .big-card::after {
      content: "";
      position: absolute;
      top: -1px;
      left: -1px;
      right: -1px;
      bottom: -1px;
      border-radius: 12px;
      pointer-events: none;
      z-index: 2;
      border: 2px solid rgba(64,224,208,0.5);
      box-shadow: 0 0 10px rgba(64,224,208,0.6), 0 0 20px rgba(64,224,208,0.4), 0 0 30px rgba(64,224,208,0.2);
      animation: borderGlow 3s infinite alternate;
    }
    @keyframes borderGlow {
      0% {
        box-shadow: 0 0 10px rgba(64,224,208,0.6),
                    0 0 20px rgba(64,224,208,0.4),
                    0 0 30px rgba(64,224,208,0.2);
      }
      100% {
        box-shadow: 0 0 20px rgba(64,224,208,0.8),
                    0 0 40px rgba(64,224,208,0.6),
                    0 0 60px rgba(64,224,208,0.4);
      }
    }
    .big-card.is-flipped {
      transform: rotateY(180deg);
    }
    .big-card-face {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      overflow: hidden;
      backface-visibility: hidden;
    }
    .big-card-front {
      background-size: cover;
      background-position: center;
      position: relative;
    }
    .big-card-front .logo {
      position: absolute;
      bottom: 8px;
      right: 8px;
      font-size: 1.2rem;
      font-family: 'Great Vibes', cursive;
    }
    .icon-flip {
      width: 20px;
      height: 20px;
      position: absolute;
      top: 8px;
      right: 8px;
      cursor: pointer;
      filter: brightness(0) invert(1);
      transition: transform 0.2s ease;
    }
    .icon-flip:active {
      transform: scale(0.9);
    }
    .big-card-back {
      background: #1b1b2d;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center; 
      align-items: center;
      padding: 15px;
      text-align: center;
      transform: rotateY(180deg);
      box-sizing: border-box;
    }
    .daily-wish {
      font-size: 1.4rem;
      font-weight: bold;
      text-shadow: none;
      min-height: 60px;
      width: 90%;
      margin: 0;
      text-align: center;
    }
    .consult-button {
      font-family: 'Great Vibes', cursive;
      font-size: 1.4rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      cursor: pointer;
      color: #fff;
      text-align: center;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
      padding: 10px 20px;
      margin-top: 20px;
      text-decoration: none;
    }
    .consult-button:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 6px rgba(64,224,208,0.6);
    }
    
    .fireflies {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }
    .firefly {
      position: absolute;
      background: radial-gradient(circle, rgba(255,255,255,1) 15%, rgba(255,255,255,0) 70%);
      border-radius: 50%;
      opacity: 0;
      animation: twinkle 5s infinite;
    }
    @keyframes twinkle {
      0% { opacity: 0; transform: scale(0.8); }
      25% { opacity: 1; transform: scale(1); filter: drop-shadow(0 0 16px #fff); }
      50% { opacity: 0; transform: scale(0.8); }
      75% { opacity: 1; transform: scale(1); filter: drop-shadow(0 0 16px #fff); }
      100% { opacity: 0; transform: scale(0.8); }
    }
    
    /* Футер */
    #mainFooter {
      position: absolute;
      bottom: 10px;
      left: 0;
      width: 100%;
      text-align: center;
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 0.8rem;
      line-height: 1.3;
    }
    #mainFooter .second-line {
      display: block;
      margin-top: 3px;
      white-space: nowrap;
    }
    
    /* Модальное окно Нотатки */
    .overlay-notes-container {
      position: relative;
      width: 400px;
      height: 600px;
      perspective: 2000px;
      transform: translateY(20px) scale(0.8);
      animation: zoomIn 3s forwards ease;
    }
    .notes-card {
      width: 100%;
      height: 100%;
      background: #1e1e2f;
      border-radius: 12px;
      position: relative;
      padding: 20px;
      box-shadow: 0 0 10px rgba(64,224,208,0.6), 0 0 20px rgba(64,224,208,0.4);
    }
    .notes-close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .notes-card h2 {
      font-family: 'Great Vibes', cursive;
      margin-bottom: 20px;
    }
    .notes-card textarea {
      width: 100%;
      height: calc(100% - 120px);
      resize: none;
      font-family: Georgia, serif;
      font-size: 1.3rem;
      padding: 10px;
      border: none;
      border-radius: 6px;
      background: repeating-linear-gradient(
        to bottom,
        #fff,
        #fff 30px,
        #dcdcdc 30px,
        #dcdcdc 31px
      );
      box-sizing: border-box;
    }
    .date-picker {
      font-family: Georgia, serif;
      font-size: 1.2rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      color: #fff;
      padding: 10px 20px;
      cursor: pointer;
      text-align: center;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
      margin-bottom: 15px;
      outline: none;
    }
    .date-picker::-webkit-inner-spin-button,
    .date-picker::-webkit-calendar-picker-indicator {
      filter: invert(1);
    }
    .social-left,
    .social-right {
      display: none !important;
    }

    /* —— Окно оплаты —— */
    #paymentOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10001;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    #paymentOverlay.active {
      display: flex;
      opacity: 1;
    }
    .payment-container {
      background: #1e1e2f;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(64,224,208,0.6), 0 0 20px rgba(64,224,208,0.4);
      max-width: 320px;
      text-align: center;
      position: relative;
      z-index: 10002;
    }
    .payment-container p {
      font-family: Georgia, serif;
      font-size: 1.2rem;
      margin-bottom: 20px;
      line-height: 1.4;
      text-align: justify;
    }
    .payment-container .btn.pay-btn {
      font-size: 1.6rem;
      padding: 12px 20px;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
    }
    .payment-container .btn.pay-btn:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 6px rgba(64,224,208,0.6);
    }
    .payment-container .btn.pay-btn:active {
      transform: scale(0.95);
    }
    /* Закрытие платёжного окошка при клике вне */
    .payment-container-close-area {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 1;
    }
  </style>
</head>
<body>
  <!-- Социальные иконки (появятся после скрытия preloader) -->
  <div class="social-left">
    <a href="#" target="_blank"><img src="https://i.ibb.co/3mvz2MS8/5-1.png" alt="Tiktok"></a>
    <a href="#" target="_blank"><img src="https://i.ibb.co/67Mpr94h/4-1.png" alt="Telegram"></a>
    <a href="#" target="_blank"><img src="https://i.ibb.co/ZR1fnmF8/3-1.png" alt="Instagram"></a>
  </div>
  <div class="social-right">
    <a href="#" target="_blank"><img src="https://i.ibb.co/GfqnLvSv/6-1.png" alt="Site Icon"></a>
  </div>
  
  <!-- Preloader -->
  <div id="preloader">
    <div class="spinner"></div>
  </div>
  
  <!-- Главное меню -->
  <div id="mainMenu" class="menu fade-in">
    <div class="greeting">
      <h1 class="glowing-title">Дзеркало душі</h1>
      <p>
        Метафоричні асоціативні карти “Дзеркало Душі” – авторська колода з 76 карт, що відкриває глибини підсвідомості та допомагає зрозуміти власні емоції. Кожна карта втілює унікальне поєднання образів і символів, відображаючи наші переживання та підсвідомі імпульси. Відкрийте свою внутрішню силу, збалансуйте емоції та знайдіть нові можливості для розвитку.
      </p>
    </div>
    <button class="btn" onclick="openDeckInfo()">Розгорнути карти</button>
    <button class="btn" onclick="openSection('sectionDiary')">Про карти</button>
    <footer id="mainFooter">
      © 2025 Усі права захищені.
      <span class="second-line">Авторська колода «Дзеркало душі» від Ірини Колоколової</span>
    </footer>
  </div>
  
  <!-- Секция "Як це працює?" -->
  <div id="sectionDiary" class="section">
    <button class="btn back-btn" onclick="backToMenu()">
      <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
    </button>
    <div class="content">
      <div class="how-it-works-text">
        <p>Метафоричні асоціативні карти – це потужний інструмент для самопізнання та особистісного розвитку, який використовується як в психологічних консультаціях, так і в особистих практиках. Вони створені на основі символічних зображень, що здатні викликати інтуїтивні асоціації, допомагаючи розкрити внутрішній світ та глибші аспекти особистості.</p>
        <p><span class="highlight">Основні переваги використання карт:</span></p>
        <ul>
          <li><strong>Саморефлексія:</strong> Глибоке занурення в особисті переживання та емоції.</li>
          <li><strong>Емоційне розвантаження:</strong> Вираження і аналіз почуттів, що допомагає звільнитися від емоційного напруження.</li>
          <li><strong>Розвиток інтуїції:</strong> Підвищення чутливості до власних внутрішніх сигналів і підсвідомих імпульсів.</li>
          <li><strong>Творчість та натхнення:</strong> Стимулювання нових ідей і перспектив через символічні образи.</li>
          <li><strong>Поглиблення зв’язку з собою:</strong> Розуміння власних мотивів, переконань та життєвих шляхів.</li>
        </ul>
        <p><span class="highlight">Як це працює:</span></p>
        <ol>
          <li><strong class="highlight">Інтуїтивний вибір:</strong><br>
            Довірте своїм внутрішнім відчуттям і оберіть карту, яка миттєво привертає вашу увагу.</li>
          <li><strong class="highlight">Детальний аналіз:</strong><br>
            Ретельно розгляньте кожну деталь зображення, символи, кольори та композицію.</li>
          <li><strong class="highlight">Саморефлексія:</strong><br>
            Задайте собі питання: Що символізує ця карта? Які емоції вона викликає? Як її образи співвідносяться з моїми переживаннями?</li>
          <li><strong class="highlight">Поглиблений аналіз:</strong><br>
            Ведіть щоденник думок і емоцій – це допоможе виявити повторювані теми.</li>
          <li><strong class="highlight">Консультація:</strong><br>
            За потреби зверніться до психолога або коуча для глибшого розуміння карт.</li>
        </ol>
      </div>
    </div>
  </div>
  
  <!-- Секция "Розгорнути колоду" -->
  <div id="sectionDeckInfo" class="section">
    <div class="nav-buttons">
      <button class="btn back-btn" onclick="backToMenu()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
      </button>
      <button class="btn continue-btn" onclick="continueToDeck()">
        <img src="https://i.ibb-co/s9NyJrT7/56-1.png" alt="Continue">
      </button>
    </div>
    <div class="content">
      <ol>
        <li><strong class="highlight">Сформулюй питання:</strong><br>Зосередься на темі, яка хвилює.</li>
        <li><strong class="highlight">Обери карту:</strong><br>Вибери ту карту, що найбільше привертає увагу.</li>
        <li><strong class="highlight">Розглянь зображення:</strong><br>Уважно вдивляйся у деталі, кольори й символи.</li>
        <li><strong class="highlight">Прислухайся:</strong><br>Зверни увагу на почуття й думки під час роботи з картою.</li>
        <li><strong class="highlight">Зроби висновки:</strong><br>Обміркуй, як карта допомагає побачити ситуацію з іншого боку.</li>
      </ol>
    </div>
  </div>
  
  <!-- Секция "Мак-карти" -->
  <div id="sectionMakKarti" class="section">
    <div class="nav-buttons">
      <!-- Кнопка "Назад" -->
      <button class="btn back-btn" onclick="backToDeckInfo()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
      </button>
      <!-- Кнопка "Перетасувати" -->
      <button id="shuffleIconBtn" class="btn shuffle-btn" onclick="shuffleCards()">
        <img src="https://i.ibb.co/jP8HZYJr/7-1.png" alt="Shuffle">
      </button>
    </div>

    <!-- Подпись под кнопками -->
    <div class="center-text">
      Прислухайся до себе та обери свою карту:
    </div>

    <!-- Сетка карт -->
    <div class="content" style="margin-top: 10px;">
      <div class="cards-grid"></div>
    </div>
  </div>
  
  <!-- Секция "72 карт" -->
  <div id="section72Cards" class="section">
    <div class="nav-buttons">
      <button class="btn back-btn" onclick="backToMakKartiFrom72()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
      </button>
    </div>
    <div class="content" style="margin-top: 10px;">
      <div class="cards-grid-72"></div>
    </div>
  </div>
  
  <!-- Оверлей большой карты -->
  <div class="overlay" id="overlay">
    <div class="overlay-card-container">
      <div class="big-card" id="bigCard">
        <div class="big-card-face big-card-front" id="bigCardFront">
          <div class="logo">by Iryna Kolok​olova</div>
          <img src="https://i.ibb-co/s9NyJrT7/56-1.png" alt="Flip" class="icon-flip" onclick="flipCard(event)">
        </div>
        <div class="big-card-face big-card-back" id="bigCardBack">
          <p class="daily-wish"></p>
          <a class="consult-button" href="https://t.me/makcards_bot" target="_blank" onclick="event.stopPropagation();">Отримати консультацію</a>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Оверлей оплаты -->
  <div id="paymentOverlay">
    <div class="payment-container-close-area" onclick="closePaymentOverlay()"></div>
    <div class="payment-container">
      <p>Для використання повної колоди «Дзеркало душі» вам потрібно сплатити повний доступ 1200 грн.</p>
      <button class="btn pay-btn" onclick="onPayClick()">Сплатити</button>
    </div>
  </div>
  
  <!-- Оверлей заметок -->
  <div class="overlay" id="notesOverlay">
    <div class="overlay-notes-container">
      <div class="notes-card" id="notesCard">
        <button class="btn back-btn notes-close-btn" onclick="closeNotesModal()">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 16 16">
            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
          </svg>
        </button>
        <h2>Нотатки:</h2>
        <input type="date" class="date-picker" id="notesDate" lang="uk" placeholder="Дата">
        <textarea id="notesTextArea" placeholder="Запишіть тут свої нотатки..."></textarea>
      </div>
    </div>
  </div>
  
  <!-- Fireflies -->
  <div class="fireflies"></div>
  
  <!-- Медитативная музыка (placeholder) -->
  <audio id="meditativeAudio" loop src="meditative.mp3"></audio>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      hidePreloader();
      // Если в URL есть ?paid=1, сохраняем оплату
      const params = new URLSearchParams(window.location.search);
      if (params.get('paid') === '1') {
        localStorage.setItem('makcards_paid', 'true');
      }
      document.getElementById('notesDate').addEventListener('change', function() {
        const selectedDate = this.value;
        const saved = localStorage.getItem('userNotes_' + selectedDate);
        document.getElementById('notesTextArea').value = saved || "";
      });
    });

    let animationInProgress = false;

    const dailyWishes = [
      "Нехай цей день принесе тобі світло, тепло та нові можливості для здійснення мрій.",
      "Бажаю, щоб кожна мить сьогодні була наповнена радістю, любов’ю та гармонією в душі.",
      "Нехай твій день буде сповнений незабутніх вражень, позитиву та натхнення для нових звершень.",
      "Бажаю успіху у всіх починаннях, теплих зустрічей та світлих думок протягом всього дня.",
      "Нехай твоє серце наповниться радістю, а кожен крок наближає тебе до великих досягнень.",
      "Бажаю, щоб сьогоднішній день відкрив перед тобою безмежні горизонти та можливості.",
      "Нехай кожна хвилина цього дня дарує тобі віру, сили та впевненість у власних силах.",
      "Бажаю, щоб у кожній миті ти знаходив натхнення, тепло та підтримку близьких.",
      "Нехай сьогоднішній день стане для тебе джерелом нових ідей, відкриттів та радості.",
      "Бажаю, щоб кожна зустріч і кожне слово надихали тебе на великі звершення.",
      "Нехай твій день буде наповнений світлими моментами, любов’ю та гармонією всередині себе.",
      "Бажаю, щоб кожна мрія набувала форми, а кожна думка перетворювалася на реальність.",
      "Нехай кожен промінчик сонця приносить тобі тепло, енергію та натхнення для нових починань.",
      "Бажаю, щоб сьогоднішній день був сповнений добрих емоцій, креативності та внутрішньої сили.",
      "Нехай кожна мить цього дня відкриває перед тобою нові можливості та приносить щастя.",
      "Бажаю, щоб кожен крок на твоєму шляху був освітлений світлом надії та впевненості.",
      "Нехай сьогоднішній день принесе тобі безліч приємних сюрпризів і незабутніх моментів.",
      "Бажаю, щоб кожна зустріч надихала тебе, а кожне слово дарувало тепло і підтримку.",
      "Нехай твій день буде сповнений творчості, радості та сміливих рішень.",
      "Бажаю, щоб сьогоднішній день став початком нових перемог і великих звершень.",
      "Нехай твоє серце наповниться оптимізмом, а думки ведуть до нових ідей та рішень.",
      "Бажаю, щоб кожна хвилина цього дня була сповнена гармонією, любов’ю та внутрішнім спокоєм.",
      "Нехай кожен промінчик світла надихає тебе на великі справи і відкриття.",
      "Бажаю, щоб сьогоднішній день приніс тобі радість, нові ідеї та життєву енергію.",
      "Нехай твій день буде наповнений яскравими фарбами, теплими зустрічами та позитивом.",
      "Бажаю, щоб кожна мить дарувала тобі натхнення, сили та віру в краще майбутнє.",
      "Нехай сьогоднішній день стане для тебе джерелом радості, творчості та нових можливостей.",
      "Бажаю, щоб кожен момент цього дня приносив тобі посмішку, тепло та гармонію.",
      "Нехай твій день буде сповнений любов’ю, підтримкою та безмежним натхненням.",
      "Бажаю, щоб цей день відкрив перед тобою нові горизонти, даруючи тепло і радість.",
      "Нехай у твоєму серці панує радість, а в душі — мир і впевненість у завтрашньому дні."
    ];

    // URL-список всех лицевых карт (только 76 первого уровня)
    const bigImages = [
      "https://i.ibb-co/N6Qz35Sh/photo-2025-05-26-17-55-31-2.jpg.webp",
      "https://i.ibb-co/0yQHT7jC/photo-2025-05-26-17-55-31-3.jpg.webp",
      "https://i.ibb-co/5XwCHmm9/photo-2025-05-26-17-55-31.jpg.webp",
      "https://i.ibb-co/nqxJW0Jz/photo-2025-05-27-23-54-14-3.jpg.webp",
      "https://i.ibb-co/4ZcMXG42/photo-2025-05-26-17-55-32-2.jpg.webp",
      "https://i.ibb-co/xSsY24T2/photo-2025-05-26-17-55-33-2.jpg.webp",
      "https://i.ibb-co/vCfXdgk7/photo-2025-05-27-23-54-14-2.jpg.webp",
      "https://i.ibb-co/9kWZFRwB/photo-2025-05-26-17-55-34-2.jpg.webp",
      "https://i.ibb-co/cSqh0Y4b/photo-2025-05-26-17-55-34.jpg.webp",
      "https://i.ibb-co/d4ZCvq9Q/photo-2025-05-26-17-55-35-3.jpg.webp",
      "https://i.ibb-co/ksxT3vR2/photo-2025-05-26-17-55-35-2.jpg.webp",
      "https://i.ibb-co/6JVD9jgJ/photo-2025-05-26-17-55-35.jpg.webp",
      "https://i.ibb-co/4Rv7DBsR/photo-2025-05-26-17-55-36-2.jpg.webp",
      "https://i.ibb-co/svP2KcgG/photo-2025-05-28-23-30-39.jpg.webp",
      "https://i.ibb-co/BKt25h6Q/photo-2025-05-26-17-55-36.jpg.webp",
      "https://i.ibb-co/21H3TC2K/photo-2025-05-26-17-55-37-2.jpg.webp",
      "https://i.ibb-co/Kx4Jq4Pq/photo-2025-05-26-17-55-37.jpg.webp",
      "https://i.ibb-co/4nsRBhPr/photo-2025-05-26-17-55-38-2.jpg.webp",
      "https://i.ibb-co/zWfj7pS8/photo-2025-05-26-17-55-38.jpg.webp",
      "https://i.ibb-co/whXpDsKv/photo-2025-05-26-17-55-39-2.jpg.webp",
      "https://i.ibb-co/5Q6f4xL/photo-2025-05-26-17-55-39-3.jpg.webp",
      "https://i.ibb-co/mr6yk1w9/photo-2025-05-26-17-55-39.jpg.webp",
      "https://i.ibb-co/YT4DND1c/photo-2025-05-26-17-55-40-2.jpg.webp",
      "https://i.ibb-co/q3q0J3zB/photo-2025-05-26-17-55-40.jpg.webp",
      "https://i.ibb-co/HpXC6N0J/photo-2025-05-26-17-55-41.jpg.webp",
      "https://i.ibb-co/wZL0158h/photo-2025-05-26-17-55-42.jpg.webp",
      "https://i.ibb-co/0xy7zGD/photo-2025-05-26-17-55-43-2.jpg.webp",
      "https://i.ibb-co/84BFk01x/photo-2025-05-26-17-55-43.jpg.webp",
      "https://i.ibb-co/dw0zVMqT/photo-2025-05-26-17-55-44-2.jpg.webp",
      "https://i.ibb-co/TxjHy32L/photo-2025-05-26-17-55-44-3.jpg.webp",
      "https://i.ibb-co/Rkvdv27Z/photo-2025-05-26-17-55-44.jpg.webp",
      "https://i.ibb-co/Q4cLfFn/photo-2025-05-26-17-55-45.jpg.webp",
      "https://i.ibb-co/FqBkJQ4P/photo-2025-05-26-17-55-46-2.jpg.webp",
      "https://i.ibb-co/Csm4t2dh/photo-2025-05-26-17-55-46.jpg.webp",
      "https://i.ibb-co/vCB2SF2Z/photo-2025-05-26-17-55-47-2.jpg.webp",
      "https://i.ibb-co/6cbbnGZb/photo-2025-05-26-17-55-47.jpg.webp",
      "https://i.ibb-co/DDGp9PHD/photo-2025-05-26-17-55-48.jpg.webp",
      "https://i.ibb-co/pBXP5Qnj/photo-2025-05-26-17-55-49.jpg.webp",
      "https://i.ibb-co/KxwKFY5x/photo-2025-05-26-17-55-50.jpg.webp",
      "https://i.ibb-co/zTDCq9Vs/photo-2025-05-26-20-48-28-2.jpg.webp",
      "https://i.ibb-co/RkJdZNVN/photo-2025-05-26-20-48-28.jpg.webp",
      "https://i.ibb-co/1J7Xpb8X/photo-2025-05-26-20-48-29.jpg.webp",
      "https://i.ibb-co/yckRk6Dj/photo-2025-05-26-20-48-30-2.jpg.webp",
      "https://i.ibb-co/CszjZVJy/photo-2025-05-26-20-48-30-3.jpg.webp",
      "https://i.ibb-co/nshy7dLG/photo-2025-05-26-20-48-30.jpg.webp",
      "https://i.ibb-co/7NxHK7t9/photo-2025-05-26-20-48-31-2.jpg.webp",
      "https://i.ibb-co/bghM15x4/photo-2025-05-26-20-48-31-3.jpg.webp",
      "https://i.ibb-co/QvKCTnsZ/photo-2025-05-26-20-48-31.jpg.webp",
      "https://i.ibb-co/p6NKKgDS/photo-2025-05-26-20-48-32-2.jpg.webp",
      "https://i.ibb-co/5WD1HQck/photo-2025-05-26-20-48-32.jpg.webp",
      "https://i.ibb-co/F4H1nXCP/photo-2025-05-26-20-48-33-2.jpg.webp",
      "https://i.ibb-co/VYxs6XYF/photo-2025-05-26-20-48-33.jpg.webp",
      "https://i.ibb-co/Vc2bGZrR/photo-2025-05-26-21-36-20-2.jpg.webp",
      "https://i.ibb-co/xKb5m45Z/photo-2025-05-26-21-36-20-3.jpg.webp",
      "https://i.ibb-co/PvQtpRch/photo-2025-05-26-21-36-20.jpg.webp",
      "https://i.ibb-co/xK33Pmmr/photo-2025-05-27-00-20-36.jpg.webp",
      "https://i.ibb-co/YBLNVbYv/photo-2025-05-27-00-20-36-3.jpg.webp",
      "https://i.ibb-co/h1HK9Svq/photo-2025-05-27-00-20-31-2.jpg.webp",
      "https://i.ibb-co/MDcJ5DL8/photo-2025-05-27-00-20-31-3.jpg.webp",
      "https://i.ibb-co/9HCytM77/photo-2025-05-27-00-20-31.jpg.webp",
      "https://i.ibb-co/0yyMVWBZ/photo-2025-05-27-00-20-32-2.jpg.webp",
      "https://i.ibb-co/svvKH579/photo-2025-05-27-00-20-32.jpg.webp",
      "https://i.ibb-co/tTf80LqY/photo-2025-05-27-00-20-33-2.jpg.webp",
      "https://i.ibb-co/20L1rPX2/photo-2025-05-27-00-20-33-3.jpg.webp",
      "https://i.ibb-co/twp0F2m5/photo-2025-05-27-00-20-33.jpg.webp",
      "https://i.ibb-co/Y4mHjmsX/photo-2025-05-27-00-20-34-2.jpg.webp",
      "https://i.ibb-co/Rp8KxrVk/photo-2025-05-27-00-20-34-3.jpg.webp",
      "https://i.ibb-co/9kw57Wyp/photo-2025-05-27-00-20-34.jpg.webp",
      "https://i.ibb-co/gZZNWsXr/photo-2025-05-27-00-20-35-2.jpg.webp",
      "https://i.ibb-co/tMv1tytj/photo-2025-05-27-00-20-35.jpg.webp",
      "https://i.ibb-co/MmjkZ07/photo-2025-05-27-00-20-36-2.jpg.webp",
      "https://i.ibb-co/wrFTdFsQ/photo-2025-05-27-00-36-27.jpg.webp",
      "https://i.ibb-co/s9VCNHWn/photo-2025-05-27-23-54-13.jpg.webp",
      "https://i.ibb-co/93ffP582/photo-2025-05-27-23-54-12.jpg.webp",
      "https://i.ibb-co/TBzZjQ0w/photo-2025-05-27-23-54-13-2.jpg.webp",
      "https://i.ibb-co/BK5sxgw8/photo-2025-05-28-23-30-40.jpg.webp"
    ];

    /**
     * Читает из localStorage массив перевёрнутых карт (по индексам).
     * Если нет – возвращает пустой массив.
     */
    function getFlippedList() {
      const raw = localStorage.getItem('makcards_flipped');
      return raw ? JSON.parse(raw) : [];
    }

    /**
     * Сохраняет в localStorage массив flipped.
     */
    function setFlippedList(arr) {
      localStorage.setItem('makcards_flipped', JSON.stringify(arr));
    }

    /**
     * Возвращает число попыток (от 0 до ∞).
     */
    function getAttempts() {
      return parseInt(localStorage.getItem('makcards_attempts') || '0', 10);
    }

    /**
     * Устанавливает число попыток.
     */
    function setAttempts(n) {
      localStorage.setItem('makcards_attempts', String(n));
    }

    /**
     * Проверяет, оплатил ли пользователь.
     */
    function isPaid() {
      return localStorage.getItem('makcards_paid') === 'true';
    }

    /**
     * Скрывает preloader, показывает меню, иконки, создаёт fireflies.
     */
    function hidePreloader() {
      const preloader = document.getElementById('preloader');
      preloader.style.opacity = '0';
      setTimeout(() => {
        preloader.style.display = 'none';
        document.getElementById('mainMenu').classList.add('show');
        showMainIcons();
        createFireflies(25);
      }, 500);
    }

    /**
     * Генерирует fireflies.
     */
    function createFireflies(count) {
      const container = document.querySelector(".fireflies");
      for (let i = 0; i < count; i++) {
        const firefly = document.createElement("div");
        firefly.className = "firefly";
        const size = 2 + Math.random() * 4;
        firefly.style.width = size + "px";
        firefly.style.height = size + "px";
        firefly.style.top = Math.random() * 100 + "%";
        firefly.style.left = Math.random() * 100 + "%";
        firefly.style.animationDelay = Math.random() * 3 + "s";
        firefly.style.animationDuration = (3 + Math.random() * 5) + "s";
        container.appendChild(firefly);
      }
    }

    /**
     * Открывает (переворачивает) большую карту в оверлее.
     */
    function openOverlay(imgUrl) {
      if (animationInProgress) return;
      animationInProgress = true;
      const overlay = document.getElementById("overlay");
      overlay.classList.add("active");
      const shuffleIcon = document.getElementById("shuffleIconBtn");
      if (shuffleIcon) shuffleIcon.style.pointerEvents = "none";
      
      // Получаем URL изображения (без префикса url("..."))
      let chosenImg = imgUrl.replace(/^url\(["']?/, "").replace(/["']?\)$/, "");
      const bigCardFront = document.getElementById("bigCardFront");
      bigCardFront.style.backgroundImage = 'url("' + chosenImg + '")';
      
      const randomWishIndex = Math.floor(Math.random() * dailyWishes.length);
      const wish = dailyWishes[randomWishIndex];
      const bigCardBack = document.getElementById("bigCardBack");
      bigCardBack.querySelector(".daily-wish").textContent = wish;
      
      const bigCard = document.getElementById("bigCard");
      bigCard.classList.remove("is-flipped");
      
      setTimeout(() => {
        animationInProgress = false;
        if (shuffleIcon) shuffleIcon.style.pointerEvents = "auto";
      }, 3000);
    }

    /**
     * Закрывает платёжное oверлей.
     */
    function closePaymentOverlay() {
      const overlay = document.getElementById('paymentOverlay');
      overlay.classList.remove('active');
    }

    /**
     * Открывает платёжное окно при переходе в диалог с ботом.
     */
    function showPaymentOverlay() {
      const overlay = document.getElementById('paymentOverlay');
      overlay.classList.add('active');
    }

    /**
     * Обработчик кнопки «Сплатити» в платёжном окне.
     * Переходит в диалог с ботом.
     */
    function onPayClick() {
      // Сразу закрываем платёжное окно
      closePaymentOverlay();
      // Открываем чат Telegram-бота
      window.location.href = 'https://t.me/makcards_bot';
    }

    /**
     * Пытается открыть карту маленькую (index — её номер от 0 до bigImages.length-1).
     * Если карта уже перевёрнута → показываем overlay.
     * Если карта не перевёрнута:
     *    • Если isPaid() → сразу openOverlay.
     *    • Иначе: если попыток < 5 → переворачиваем и сохраняем, иначе → платёжное окно.
     */
    function tryOpenCard(smallCard, index) {
      if (animationInProgress) return;

      const flippedList = getFlippedList();
      const alreadyFlipped = flippedList.includes(index);

      if (alreadyFlipped || isPaid()) {
        // Если уже перевёрнут или оплата есть – просто открываем overlay
        if (!alreadyFlipped && !flippedList.includes(index)) {
          // Если isPaid, но не было в списке, добавляем – чтобы отображалось
          flippedList.push(index);
          setFlippedList(flippedList);
        }
        openOverlay(smallCard.dataset.front);
        return;
      }

      // Если не перевёрнут и не оплачен
      const attempts = getAttempts();
      if (attempts < 5) {
        // Разрешаем открыть: переворачиваем маленькую
        smallCard.style.backgroundImage = `url("${smallCard.dataset.front}")`;
        smallCard.classList.add("flipped");
        flippedList.push(index);
        setFlippedList(flippedList);

        const newCount = attempts + 1;
        setAttempts(newCount);

        // Если после этого попытки == 5: блокируем остальные
        if (newCount >= 5) {
          document.querySelectorAll(".cards-grid .small-card")
            .forEach(cardElem => {
              if (!cardElem.classList.contains("flipped")) {
                cardElem.style.pointerEvents = "none";
                cardElem.style.opacity = "0.5";
              }
            });
        }

        // Открываем overlay с увеличенной картой
        openOverlay(smallCard.dataset.front);
      } else {
        // Если попыток уже 5+: показываем платёжное окно
        showPaymentOverlay();
      }
    }

    /**
     * Создаёт все маленькие карты (их число = bigImages.length).
     * При загрузке проверяет localStorage, чтобы восстановить:
     *   • Перевёрнутые (flipped) карты,
     *   • Заблокировать (opacity 0.5, pointerEvents none) все неперевёрнутые, если attempts >=5.
     */
    function createSmallCards() {
      disableInteractions();
      const grid = document.querySelector(".cards-grid");
      grid.innerHTML = "";
      const flippedList = getFlippedList();
      const attempts = getAttempts();
      const blockedAll = attempts >= 5 && !isPaid();

      bigImages.forEach((imgUrl, index) => {
        const container = document.createElement("div");
        container.classList.add("card-container");
        // рандомная разброска
        const angle = Math.random() * Math.PI * 2;
        const distance = 50 + Math.random() * 50;
        container.style.transform =
          `scale(0.9) translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;

        // создаём одну small-card
        const smallCard = document.createElement("div");
        smallCard.classList.add("small-card");
        smallCard.dataset.front = imgUrl;
        // Если было перевёрнуто ранее, сразу ставим лицо
        if (flippedList.includes(index) || isPaid()) {
          smallCard.classList.add("flipped");
          smallCard.style.backgroundImage = `url("${imgUrl}")`;
        } else {
          // Иначе – рубашка
          smallCard.style.backgroundImage = 'url("https://i.ibb-co/wcWxxGp/IMG-8462.webp")';
        }

        // Если все заблокированы (attempts>=5 и не paid), блокируем неперевёрнутые
        if (blockedAll && !smallCard.classList.contains("flipped")) {
          smallCard.style.pointerEvents = "none";
          smallCard.style.opacity = "0.5";
        }

        // По клику пробуем открыть карту с учётом limit
        smallCard.addEventListener("click", function() {
          tryOpenCard(smallCard, index);
        });

        container.appendChild(smallCard);
        grid.appendChild(container);

        // анимация появления
        setTimeout(() => {
          container.classList.add("fade-in");
          container.style.transform = "";
        }, 50);
      });

      // вернуть кликабельность после анимации
      setTimeout(enableInteractions, 6000);
    }

    /**
     * Перемешивает маленькие карты (анимационно), затем пересоздаёт.
     */
    function shuffleCards() {
      disableInteractions();
      const grid = document.querySelector(".cards-grid");
      const containers = Array.from(grid.querySelectorAll(".card-container"));
      containers.forEach(container => {
        const angle = Math.random() * Math.PI * 2;
        const distance = 50 + Math.random() * 50;
        container.style.transform = `scale(0.9) translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;
        container.style.opacity = "0";
      });
      setTimeout(() => {
        createSmallCards();
      }, 6000);
    }

    /**
     * Функция поворота большой карты при клике по ней.
     */
    function flipCard(event) {
      event.stopPropagation();
      if (animationInProgress) return;
      document.getElementById("bigCard").classList.toggle("is-flipped");
    }

    function disableInteractions() {
      animationInProgress = true;
      const grid20 = document.querySelector(".cards-grid");
      if (grid20) grid20.style.pointerEvents = "none";
      const grid72 = document.querySelector(".cards-grid-72");
      if (grid72) grid72.style.pointerEvents = "none";
      const shuffleIcon = document.getElementById("shuffleIconBtn");
      if (shuffleIcon) shuffleIcon.style.pointerEvents = "none";
    }
    function enableInteractions() {
      animationInProgress = false;
      const grid20 = document.querySelector(".cards-grid");
      if (grid20) grid20.style.pointerEvents = "auto";
      const grid72 = document.querySelector(".cards-grid-72");
      if (grid72) grid72.style.pointerEvents = "auto";
      const shuffleIcon = document.getElementById("shuffleIconBtn");
      if (shuffleIcon) shuffleIcon.style.pointerEvents = "auto";
    }

    function showMainIcons() {
      document.querySelector('.social-left').style.display = 'flex';
      document.querySelector('.social-right').style.display = 'flex';
    }
    function hideMainIcons() {
      document.querySelector('.social-left').style.display = 'none';
      document.querySelector('.social-right').style.display = 'none';
    }
    
    function openSection(sectionId) {
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('mainFooter').style.display = 'none';
      hideMainIcons();
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
    }
    function backToMenu() {
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
      document.getElementById('mainMenu').style.display = 'flex';
      document.getElementById('mainFooter').style.display = 'block';
      showMainIcons();
    }
    function openDeckInfo() {
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('mainFooter').style.display = 'none';
      hideMainIcons();
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
      document.getElementById('sectionDeckInfo').classList.add('active');
    }
    function continueToDeck() {
      document.getElementById('sectionDeckInfo').classList.remove('active');
      document.getElementById('sectionMakKarti').classList.add('active');
      createSmallCards();
    }
    function backToDeckInfo() {
      document.getElementById('sectionMakKarti').classList.remove('active');
      document.getElementById('sectionDeckInfo').classList.add('active');
    }
    function open72Cards() {
      document.getElementById('sectionMakKarti').classList.remove('active');
      document.getElementById('section72Cards').classList.add('active');
      create72Cards();
    }
    function backToMakKartiFrom72() {
      document.getElementById('section72Cards').classList.remove('active');
      document.getElementById('sectionMakKarti').classList.add('active');
    }
    function create72Cards() {
      disableInteractions();
      const grid = document.querySelector(".cards-grid-72");
      grid.innerHTML = "";
      bigImages.forEach(imgUrl => {
        const container = document.createElement("div");
        container.classList.add("card-container");
        container.style.opacity = "0";
        
        const smallCard = document.createElement("div");
        smallCard.classList.add("small-card");
        
        const front = document.createElement("div");
        front.classList.add("small-card-front");
        front.style.backgroundImage = 'url("' + imgUrl + '")';
        
        smallCard.appendChild(front);
        container.appendChild(smallCard);
        grid.appendChild(container);
        
        setTimeout(() => {
          container.classList.add("fade-in");
          container.style.opacity = "1";
        }, 50);
        
        smallCard.addEventListener("click", function(e) {
          if (animationInProgress) return;
          let bg = front.style.backgroundImage;
          openOverlay(bg);
        });
      });
      setTimeout(enableInteractions, 2000);
    }

    const soundBtn = document.getElementById('soundBtn');
    const meditativeAudio = document.getElementById('meditativeAudio');
    let isPlaying = false;
    if (soundBtn) {
      soundBtn.addEventListener('click', function(e) {
        if (!isPlaying) {
          meditativeAudio.play();
          soundBtn.classList.remove('muted');
          isPlaying = true;
        } else {
          meditativeAudio.pause();
          soundBtn.classList.add('muted');
          isPlaying = false;
        }
      });
    }

    /* Модальное окно заметок */
    function openNotes() {
      const dateInput = document.getElementById('notesDate');
      if (!dateInput.value) {
        let today = new Date();
        let yyyy = today.getFullYear();
        let mm = String(today.getMonth() + 1).padStart(2, '0');
        let dd = String(today.getDate()).padStart(2, '0');
        dateInput.value = yyyy + '-' + mm + '-' + dd;
      }
      let selectedDate = dateInput.value;
      let savedNotes = localStorage.getItem('userNotes_' + selectedDate);
      document.getElementById('notesTextArea').value = savedNotes || "";
      document.getElementById('notesOverlay').classList.add('active');
    }

    function closeNotesModal() {
      let notes = document.getElementById('notesTextArea').value;
      let notesDate = document.getElementById('notesDate').value;
      if (!notesDate) {
        let today = new Date();
        let yyyy = today.getFullYear();
        let mm = String(today.getMonth() + 1).padStart(2, '0');
        let dd = String(today.getDate()).padStart(2, '0');
        notesDate = yyyy + '-' + mm + '-' + dd;
      }
      localStorage.setItem('userNotes_' + notesDate, notes);
      document.getElementById('notesOverlay').classList.remove('active');
    }

    document.getElementById('notesOverlay').addEventListener("click", function(e) {
      if (e.target.id === "notesOverlay") {
        closeNotesModal();
      }
    });

  </script>
</body>
</html>
