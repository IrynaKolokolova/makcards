<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <!-- Запрещаем масштабирование -->
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <title>Дзеркало душі — Односторінковий додаток</title>
  
  <!-- Подключение шрифта Great Vibes (только для заголовка и кнопок) -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  
  <!-- Подключение красивого курсивного шрифта (Allura) -->
  <link href="https://fonts.googleapis.com/css2?family=Allura&display=swap" rel="stylesheet">

  <style>
    /* ================================================
       ОБЩИЕ СТИЛИ (как в оригинале)
       ================================================ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      overflow-x: hidden;
      overflow-y: auto;
    }
    body {
      font-family: 'Allura', cursive;
      background: linear-gradient(135deg, #12122b, #232342);
      color: #fff;
      height: 100vh;
      position: relative;
      font-size: 1.3rem;
      line-height: 1.3;
    }
    body, h1, h2, h3, h4, h5, h6, p, li, a, button, .btn, .highlight {
      text-shadow: 2px 2px 4px rgba(0,0,0,1);
    }

    /* Preloader */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #1e1e2f;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      transition: opacity 0.3s ease;
    }
    .spinner {
      border: 4px solid rgba(64,224,208,0.2);
      border-top: 4px solid rgba(64,224,208,0.8);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Анимированное название */
    .glowing-title {
      font-family: 'Great Vibes', cursive;
      font-size: 3rem;
      font-weight: bold;
      color: #fff;
      margin-top: -10px;
      margin-bottom: 10px;
      animation: glow 2s ease-in-out infinite alternate;
      text-align: center;
    }
    @keyframes glow {
      from { text-shadow: 0 0 2px rgba(255,255,255,0.3), 0 0 4px rgba(255,255,255,0.3); }
      to   { text-shadow: 0 0 3px rgba(255,255,255,0.4), 0 0 5px rgba(255,255,255,0.4); }
    }

    .highlight {
      color: #fff;
      text-shadow: 0 0 6px rgba(255,255,255,0.8);
    }

    .btn, .content, .deck-icons, .icon-btn {
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .fade-in.show, .fade-in.fade-in {
      opacity: 1;
      transform: translateY(0);
    }

    /* Главное меню */
    .menu {
      display: flex;
      flex-direction: column;
      gap: 20px;
      justify-content: center;
      justify-content: flex-start;   /* прижмёт всё вверх */
      align-items: center;
      height: 100vh;
      text-align: center;
      position: relative;
      z-index: 2;
      max-width: 90%;
      margin: 0 auto;
      padding: 10px;
      padding: 60px 10px 10px;
    }
    .greeting p {
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 1.2rem;
      line-height: 1.3;
      max-width: 100%;
      text-align: justify;
      margin-bottom: 10px;
      margin-top: 20px;
    }

    .btn {
      font-family: 'Great Vibes', cursive;
      font-style: normal;
      min-width: 250px;
      padding: 15px 30px;
      font-size: 1.8rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      cursor: pointer;
      color: #fff;
      text-align: center;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
      position: relative;
      overflow: hidden;
    }
    .btn:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 6px rgba(64,224,208,0.6);
    }
    .btn:active {
      transform: scale(0.95);
    }
    .btn::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(64,224,208,0.5), transparent 70%);
      opacity: 0;
      animation: buttonGlow 2.5s infinite;
      z-index: -1;
    }
    @keyframes buttonGlow {
      0% { opacity: 0; }
      50% { opacity: 0.5; }
      100% { opacity: 0; }
    }

    /* Кнопки «Назад», «Продовжити», «Перетасувати», «Звук» */
    .btn.back-btn, .btn.continue-btn, .btn.sound-btn {
      padding: 4px 10px;
      min-width: auto;
      min-height: auto;
      width: auto;
      height: auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .btn.back-btn img, .btn.continue-btn img, .btn.sound-btn img {
      width: 16px;
      height: 16px;
      filter: brightness(0) invert(1);
    }
    .btn.back-btn img { transform: rotate(180deg); }
    .btn.continue-btn img { transform: scaleY(-1); }

    .btn.shuffle-btn {
      padding: 4px 10px;
      min-width: auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .btn.shuffle-btn img {
      filter: brightness(0) invert(1);
      width: 17px;
      height: 17px;
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 10px;
    }

    .center-text {
      font-family: Georgia, serif;
      font-size: 1rem;
      font-style: italic;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,1);
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
    }
    #sectionMakKarti .center-text {
      display: block !important;
      width: 100%;
      text-align: center;
      margin: 10px 0;
    }

    .deck-icons {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-top: 15px;
    }
    .icon-btn {
      width: 50px;
      height: 50px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      cursor: pointer;
      transition: opacity 0.5s ease, transform 0.5s ease, box-shadow 0.5s ease;
    }
    .icon-btn:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 8px rgba(64,224,208,0.7);
    }
    .icon-btn:active {
      transform: scale(0.95);
    }
    .icon-btn img {
      width: 30px;
      height: 30px;
      filter: brightness(0) invert(1);
    }

    /* Скрываем соц. иконки, чтобы не мешались (как в оригинале) */
    .social-left, .social-right {
      display: none !important;
    }

    /* ================================================
       СЕКЦИИ
       ================================================ */
    .section {
      display: none;
      padding: 10px;
      z-index: 2;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch;
    }
    #sectionDiary {
      overflow-y: auto !important;
    }
    .section.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }

    /* Контент секций */
    .content {
      max-width: 90%;
      margin: 30px auto 0 auto;
      font-size: 1.6rem;
      line-height: 1.5;
      text-align: justify;
      color: #fff;
      padding: 0 20px;
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    #sectionDiary .content {
      max-width: 100%;
      padding: 20px;
    }
    .how-it-works-text p,
    .how-it-works-text ul,
    .how-it-works-text ol {
      margin-bottom: 15px;
    }
    .how-it-works-text {
      padding: 15px;
      text-align: justify;
      font-size: 1.2rem;
      font-family: Georgia, serif;
      font-style: italic;
      text-shadow: none;
    }

    /* Секция "Розгорнути колоду" */
    #sectionDeckInfo {
      overflow: hidden;
    }
    #sectionDeckInfo .content {
      max-width: 90%;
      margin: 40px auto 0 auto;
      font-size: 1.6rem;
      line-height: 1.5;
      text-align: justify;
      color: #fff;
      padding: 0 20px;
    }
    #sectionDeckInfo .content li,
    #sectionDeckInfo .content p,
    #sectionDeckInfo .content ol {
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 1.2rem;
      line-height: 1.3;
      text-shadow: none;
      text-align: justify;
    }

    /* Секция "Мак-карти" */
    #sectionMakKarti {
      overflow: hidden;
    }
    #sectionMakKarti .content {
      max-width: 90%;
      margin: -5px auto 0 auto;
      font-size: 1.6rem;
      line-height: 1.5;
      text-align: center;
      position: relative;
      padding: 10px;
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(4, 80px);
      grid-auto-rows: 112px;
      gap: 10px;
      justify-content: center;
      align-items: start;
      max-width: 600px;
      margin: 0 auto;
    }
    .card-container {
      width: 80px;
      height: 112px;
      perspective: 1000px;
      position: relative;
      opacity: 0;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .card-container.fade-in {
      opacity: 1;
      transform: none;
    }
    .small-card {
      width: 100%;
      height: 100%;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      border: 1px solid rgba(64,224,208,0.6);
      box-shadow: 0 0 10px rgba(64,224,208,0.3);
      transition: transform 0.2s, opacity 0.3s;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    .small-card:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px rgba(64,224,208,0.6);
    }
    .small-card:active {
      transform: scale(0.95);
      box-shadow: 0 0 12px rgba(64,224,208,0.6);
    }
    .small-card.flipped {
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    /* Секция "72 карт" */
    #section72Cards {
      overflow-y: auto;
    }
    #section72Cards .content {
      padding: 10px;
      margin-top: -5px;
    }
    .cards-grid-72 {
      display: grid;
      grid-template-columns: repeat(4, 60px) !important;
      grid-auto-rows: 95px;
      gap: 30px;
      justify-content: center;
      align-items: start;
      max-width: calc(60px * 5 + 10px * 4) !important;
      margin: 0 auto;
      margin-left: -2px;
    }
    #section72Cards .card-container {
      width: 60px;
      height: 84px;
      perspective: 1000px;
      position: relative;
    }

    /* Большая карта (overlay) */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .overlay.active {
      display: flex;
      opacity: 1;
    }
    @keyframes zoomIn {
      0% { opacity: 0; transform: translateY(20px) scale(0.8); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    .overlay-card-container {
      position: relative;
      width: 320px;
      height: 448px;
      perspective: 2000px;
      transform: translateY(20px) scale(0.8);
      animation: zoomIn 3s forwards ease;
    }
    .big-card {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      border-radius: 12px;
      transition: transform 0.8s cubic-bezier(0.4, 0.2, 0.2, 1);
    }
    .big-card::after {
      content: "";
      position: absolute;
      top: -1px;
      left: -1px;
      right: -1px;
      bottom: -1px;
      border-radius: 12px;
      pointer-events: none;
      z-index: 2;
      border: 2px solid rgba(64,224,208,0.5);
      box-shadow: 0 0 10px rgba(64,224,208,0.6), 0 0 20px rgba(64,224,208,0.4), 0 0 30px rgba(64,224,208,0.2);
      animation: borderGlow 3s infinite alternate;
    }
    @keyframes borderGlow {
      0% {
        box-shadow: 0 0 10px rgba(64,224,208,0.6),
                    0 0 20px rgba(64,224,208,0.4),
                    0 0 30px rgba(64,224,208,0.2);
      }
      100% {
        box-shadow: 0 0 20px rgba(64,224,208,0.8),
                    0 0 40px rgba(64,224,208,0.6),
                    0 0 60px rgba(64,224,208,0.4);
      }
    }
    .big-card.is-flipped {
      transform: rotateY(180deg);
    }
    .big-card-face {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      overflow: hidden;
      backface-visibility: hidden;
    }
    .big-card-front {
      background-size: cover;
      background-position: center;
      position: relative;
    }
    .big-card-front .logo {
      position: absolute;
      bottom: 8px;
      right: 8px;
      font-size: 1.2rem;
      font-family: 'Great Vibes', cursive;
    }
    .icon-flip {
      width: 20px;
      height: 20px;
      position: absolute;
      top: 8px;
      right: 8px;
      cursor: pointer;
      filter: brightness(0) invert(1);
      transition: transform 0.2s ease;
    }
    .icon-flip:active {
      transform: scale(0.9);
    }
    .big-card-back {
      background: #1b1b2d;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center; 
      align-items: center;
      padding: 15px;
      text-align: center;
      transform: rotateY(180deg);
      box-sizing: border-box;
    }
    .daily-wish {
      font-size: 1.4rem;
      font-weight: bold;
      text-shadow: none;
      min-height: 60px;
      width: 90%;
      margin: 0;
      text-align: center;
    }
    .consult-button {
      font-family: 'Great Vibes', cursive;
      font-style: normal;
      min-width: 180px;
      padding: 10px 20px;
      font-size: 1.4rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      cursor: pointer;
      color: #fff;
      text-align: center;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
      position: relative;
      overflow: hidden;
      margin-top: 20px;
      text-decoration: none;
    }
    .consult-button:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 6px rgba(64,224,208,0.6);
    }

    /* Футер */
    #mainFooter {
      position: absolute;
      bottom: 10px;
      left: 0;
      width: 100%;
      text-align: center;
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 0.8rem;
      line-height: 1.3;
    }
    #mainFooter .second-line {
      display: block;
      margin-top: 3px;
      white-space: nowrap;
    }

    /* Модальное окно Нотатки */
    .overlay-notes-container {
      position: relative;
      width: 400px;
      height: 600px;
      perspective: 2000px;
      transform: translateY(20px) scale(0.8);
      animation: zoomIn 3s forwards ease;
    }
    .notes-card {
      width: 100%;
      height: 100%;
      background: #1e1e2f;
      border-radius: 12px;
      position: relative;
      padding: 20px;
      box-shadow: 0 0 10px rgba(64,224,208,0.6), 0 0 20px rgba(64,224,208,0.4);
    }
    .notes-close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .notes-card h2 {
      font-family: 'Great Vibes', cursive;
      margin-bottom: 20px;
    }
    .notes-card textarea {
      width: 100%;
      height: calc(100% - 120px);
      resize: none;
      font-family: Georgia, serif;
      font-size: 1.3rem;
      padding: 10px;
      border: none;
      border-radius: 6px;
      background: repeating-linear-gradient(
        to bottom,
        #fff,
        #fff 30px,
        #dcdcdc 30px,
        #dcdcdc 31px
      );
      box-sizing: border-box;
    }
    .date-picker {
      font-family: Georgia, serif;
      font-size: 1.2rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      color: #fff;
      padding: 10px 20px;
      cursor: pointer;
      text-align: center;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
      margin-bottom: 15px;
      outline: none;
    }
    .date-picker::-webkit-inner-spin-button,
    .date-picker::-webkit-calendar-picker-indicator {
      filter: invert(1);
    }

    /* Модальное окно оплаты */
    #paymentOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10001;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    #paymentOverlay.active {
      display: flex;
      opacity: 1;
    }
    .payment-modal {
      background: #1b1b2d;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      max-width: 320px;
    }
    .payment-modal p {
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    .payment-modal a.btn {
      display: inline-block;
      margin-top: 10px;
      text-decoration: none;
      font-family: 'Great Vibes', cursive;
      font-size: 1.5rem;
      background: rgba(64,224,208,0.2);
      border: 1px solid rgba(64,224,208,0.5);
      border-radius: 6px;
      color: #fff;
      padding: 10px 20px;
      box-shadow: 0 0 4px rgba(64,224,208,0.5);
    }
    .payment-modal a.btn:hover {
      background: rgba(64,224,208,0.4);
      box-shadow: 0 0 6px rgba(64,224,208,0.6);
    }
  </style>
</head>
<body>
  <!-- Preloader -->
  <div id="preloader">
    <div class="spinner"></div>
  </div>
  
  <!-- Главное меню -->
  <div id="mainMenu" class="menu fade-in">
    <div class="greeting">
      <h1 class="glowing-title">Дзеркало душі</h1>
      <p>
        Метафоричні асоціативні карти “Дзеркало Душі” – авторська колода з 76 карт, що відкриває глибини підсвідомості та допомагає зрозуміти власні емоції. Кожна карта втілює унікальне поєднання образів і символів, відображаючи наші переживання та підсвідомі імпульси. Відкрийте свою внутрішню силу, збалансуйте емоції та знайдіть нові можливості для розвитку.
      </p>
    </div>
    <!-- Именно эти две кнопки (как было изначально) -->
    <button class="btn" onclick="openDeckInfo()">Розгорнути карти</button>
    <button class="btn" onclick="openSection('sectionDiary')">Про карти</button>
    <footer id="mainFooter">
      © 2025 Усі права захищені.
      <span class="second-line">Авторська колода «Дзеркало душі» від Ірини Колоколової</span>
    </footer>
  </div>
  
  <!-- Секция "Як це працює?" -->
  <div id="sectionDiary" class="section">
    <button class="btn back-btn" onclick="backToMenu()">
      <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
    </button>
    <div class="content">
      <div class="how-it-works-text">
        <p>Метафоричні асоціативні карти – це потужний інструмент для самопізнання та особистісного розвитку, який використовується як в психологічних консультаціях, так і в особистих практиках. Вони створені на основі символічних зображень, що здатні викликати інтуїтивні асоціації, допомагаючи розкрити внутрішній світ та глибші аспекти особистості.</p>
        <p><span class="highlight">Основні переваги використання карт:</span></p>
        <ul>
          <li><strong>Саморефлексія:</strong> Глибоке занурення в особисті переживання та емоції.</li>
          <li><strong>Емоційне розвантаження:</strong> Вираження і аналіз почуттів, що допомагає звільнитися від емоційного напруження.</li>
          <li><strong>Розвиток інтуїції:</strong> Підвищення чутливості до власних внутрішніх сигналів і підсвідомих імпульсів.</li>
          <li><strong>Творчість та натхнення:</strong> Стимулювання нових ідей і перспектив через символічні образи.</li>
          <li><strong>Поглиблення зв’язку з собою:</strong> Розуміння власних мотивів, переконань та життєвих шляхів.</li>
        </ul>
        <p><span class="highlight">Як це працює:</span></p>
        <ol>
          <li><strong class="highlight">Інтуїтивний вибір:</strong><br>
            Довірте своїм внутрішнім відчуттям і оберіть карту, яка миттєво привертає вашу увагу. Ваш вибір може бути обумовлений як кольорами, так і символами, що відгукуються у вашій душі.
          </li>
          <li><strong class="highlight">Детальний аналіз:</strong><br>
            Ретельно розгляньте кожну деталь зображення:
            <ul>
              <li><em>Символи:</em> Відображають глибинні аспекти вашої особистості та життєвих ситуацій;</li>
              <li><em>Кольори:</em> Передають емоційне забарвлення і можуть впливати на ваше поточне самопочуття;</li>
              <li><em>Композиція:</em> Підказує про взаємозв’язки між різними аспектами вашого життя.</li>
            </ul>
          </li>
          <li><strong class="highlight">Саморефлексія:</strong><br>
            Поставте собі запитання:
            <ul>
              <li>Що символізує ця карта для мене?</li>
              <li>Які емоції вона викликає?</li>
              <li>Як її образи співвідносяться з моїми особистими переживаннями?</li>
            </ul>
          </li>
          <li><strong class="highlight">Поглиблений аналіз:</strong><br>
            Вивчіть власні реакції та асоціації. Ведіть щоденник, у якому фіксуються ваші думки та емоції після роботи з картами – це допоможе виявити повторювані теми та сигнали вашої підсвідомості.
          </li>
          <li><strong class="highlight">Консультація:</strong><br>
            За потреби зверніться до психолога або коуча, який спеціалізується на роботі з асоціативними картами. Професійна підтримка допоможе глибше зрозуміти зміст образів і використати їх для особистісного зростання.
          </li>
        </ol>
        <p>Таким чином, метафоричні асоціативні карти стають містком між свідомістю та підсвідомістю, відкриваючи нові шляхи для самопізнання та внутрішнього розвитку. Вони сприяють не лише розумінню себе, але й стимулюють творчий процес, допомагаючи знайти відповіді на важливі життєві питання.</p>
      </div>
    </div>
  </div>
  
  <!-- Секция "Розгорнути колоду" -->
  <div id="sectionDeckInfo" class="section">
    <div class="nav-buttons">
      <button class="btn back-btn" onclick="backToMenu()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
      </button>
      <button class="btn continue-btn" onclick="continueToDeck()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Continue">
      </button>
    </div>
    <div class="content">
      <ol>
        <li><strong class="highlight">Сформулюй питання:</strong><br>Зосередься на темі, яка хвилює. Подумай, що саме ти хочеш зрозуміти чи змінити.</li>
        <li><strong class="highlight">Обери карту:</strong><br>Вибери з колоди ту, що привертає увагу чи викликає особливий відгук у душі.</li>
        <li><strong class="highlight">Розглянь зображення:</strong><br>Уважно вдивляйся у деталі, кольори та символи, які можуть приховувати важливі підказки.</li>
        <li><strong class="highlight">Прислухайся:</strong><br>Зверни увагу на почуття та думки, що виникають у процесі споглядання, аналізуй власні реакції.</li>
        <li><strong class="highlight">Зроби висновки:</strong><br>Подумай, як ця карта може допомогти тобі побачити ситуацію під іншим кутом і знайти відповіді.</li>
      </ol>
    </div>
  </div>
  
  <!-- Секция "Мак-карти" -->
  <div id="sectionMakKarti" class="section">
    <div class="nav-buttons">
      <!-- Кнопка "Назад" -->
      <button class="btn back-btn" onclick="backToDeckInfo()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
      </button>
      <!-- Кнопка "Перетасувати" -->
      <button id="shuffleIconBtn" class="btn shuffle-btn" onclick="shuffleCards()">
        <img src="https://i.ibb.co/jP8HZYJr/7-1.png" alt="Shuffle">
      </button>
    </div>

    <!-- Подпись под кнопками -->
    <div class="center-text">
      Прислухайся до себе та обери свою карту:
    </div>

    <!-- Сетка карт -->
    <div class="content" style="margin-top: 10px;">
      <div class="cards-grid"></div>
    </div>
  </div>
  
  <!-- Секция "72 карт" -->
  <div id="section72Cards" class="section">
    <div class="nav-buttons">
      <button class="btn back-btn" onclick="backToMakKartiFrom72()">
        <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Back">
      </button>
    </div>
    <div class="content" style="margin-top: 10px;">
      <div class="cards-grid-72"></div>
    </div>
  </div>
  
  <!-- Глобальный оверлей для карточки -->
  <div class="overlay" id="overlay">
    <div class="overlay-card-container">
      <div class="big-card" id="bigCard">
        <div class="big-card-face big-card-front" id="bigCardFront">
          <div class="logo">by Iryna Kolokolova</div>
          <img src="https://i.ibb.co/s9NyJrT7/56-1.png" alt="Flip" class="icon-flip" onclick="flipCard(event)">
        </div>
        <div class="big-card-face big-card-back" id="bigCardBack">
          <p class="daily-wish"></p>
          <a class="consult-button" href="https://t.me/irynakolokolovamak_bot" target="_blank" onclick="event.stopPropagation();">Отримати консультацію</a>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Глобальный оверлей для нотаток -->
  <div class="overlay" id="notesOverlay">
    <div class="overlay-notes-container">
      <div class="notes-card" id="notesCard">
        <button class="btn back-btn notes-close-btn" onclick="closeNotesModal()">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 16 16">
            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 
            .708.708L8.707 8l2.647 2.646a.5.5 
            0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
          </svg>
        </button>
        <h2>Нотатки:</h2>
        <input type="date" class="date-picker" id="notesDate" lang="uk" placeholder="Дата">
        <textarea id="notesTextArea" placeholder="Запишіть тут свої нотатки..."></textarea>
      </div>
    </div>
  </div>
  
  <!-- Модальное окно оплаты -->
  <div class="overlay" id="paymentOverlay">
    <div class="payment-modal">
      <p>Для доступу до всієї колоди потрібно оплатити повний доступ. Ціна: 1200 грн</p>
      <a href="#" id="payButton" class="btn">Сплатити 💳</a>
    </div>
  </div>
  
  <!-- Огни (fireflies) -->
  <div class="fireflies"></div>
  
  <!-- Аудіо для медитативной музики (placeholder) -->
  <audio id="meditativeAudio" loop src="meditative.mp3"></audio>
  
  <script>
    // ================================================
    // КОНСТАНТЫ И ПЕРЕМЕННЫЕ
    // ================================================
    const FREE_LIMIT = 5;           // 5 бесплатных карт
    const APP_URL   = "https://irynakolokolova.github.io/makcards/";
    let animationInProgress = false;

    // Хранение индексов перевернутых карт
    function loadFlippedIndices() {
      try {
        const stored = localStorage.getItem('flippedIndices');
        return stored ? JSON.parse(stored) : [];
      } catch {
        return [];
      }
    }
    function saveFlippedIndices(arr) {
      localStorage.setItem('flippedIndices', JSON.stringify(arr));
    }

    // Проверка полного доступа
    function hasFullAccess() {
      return localStorage.getItem('hasFullAccess') === 'true';
    }
    function grantFullAccess() {
      localStorage.setItem('hasFullAccess', 'true');
    }

    // ================================================
    // ОБРАБОТЧИКИ ЗАГРУЗКИ
    // ================================================
    document.addEventListener('DOMContentLoaded', function() {
      hidePreloader();

      // Обработка параметра ?access=1
      const params = new URLSearchParams(window.location.search);
      if (params.get('access') === '1') {
        grantFullAccess();
      }

      // Кнопка оплаты
      document.getElementById('payButton').addEventListener('click', function(e) {
        e.preventDefault();
        // Запускаем Web App через Telegram: tg://resolve?domain=<bot_username>&start=payment
        // Но внутри WebApp адрес open вызовет переход нативного Telegram.
        // Здесь мы делаем window.open с deep-link, чтобы внутри WebApp открылся бот.
        window.open("tg://resolve?domain=irynakolokolovamak_bot&start=payment", "_blank");
      });

      // Обработчик изменения даты (Нотатки)
      document.getElementById('notesDate').addEventListener('change', function() {
        const selDate = this.value;
        const saved = localStorage.getItem('userNotes_' + selDate);
        document.getElementById('notesTextArea').value = saved || "";
      });

      // Закрытие окна оплаты при клике вне модального блока
      document.getElementById('paymentOverlay').addEventListener('click', function(e) {
        if (e.target.id === 'paymentOverlay') {
          this.classList.remove('active');
        }
      });
    });

    function hidePreloader() {
      const pre = document.getElementById('preloader');
      pre.style.opacity = '0';
      setTimeout(() => {
        pre.style.display = 'none';
        document.getElementById('mainMenu').classList.add('show');
        createFireflies(25);
      }, 500);
    }
    function createFireflies(count) {
      const container = document.querySelector(".fireflies");
      for (let i = 0; i < count; i++) {
        const firefly = document.createElement("div");
        firefly.className = "firefly";
        const size = 2 + Math.random() * 4;
        firefly.style.width = size + "px";
        firefly.style.height = size + "px";
        firefly.style.top = Math.random() * 100 + "%";
        firefly.style.left = Math.random() * 100 + "%";
        firefly.style.animationDelay = Math.random() * 3 + "s";
        firefly.style.animationDuration = (3 + Math.random() * 5) + "s";
        container.appendChild(firefly);
      }
    }

    // ================================================
    // МАССИВ ИЗОБРАЖЕНИЙ 76 КАРТ
    // ================================================
    const bigImages = [
      /* Здесь 76 URL-ов ваших карт (как в предыдущем варианте). 
         Пример первых 10: */
      "https://i.ibb.co/N6Qz35Sh/photo-2025-05-26-17-55-31-2.jpg.webp",
      "https://i.ibb.co/0yQHT7jC/photo-2025-05-26-17-55-31-3.jpg.webp",
      "https://i.ibb.co/5XwCHmm9/photo-2025-05-26-17-55-31.jpg.webp",
      "https://i.ibb.co/nqxJW0Jz/photo-2025-05-27-23-54-14-3.jpg.webp",
      "https://i.ibb.co/4ZcMXG42/photo-2025-05-26-17-55-32-2.jpg.webp",
      "https://i.ibb.co/xSsY24T2/photo-2025-05-26-17-55-33-2.jpg.webp",
      "https://i.ibb.co/vCfXdgk7/photo-2025-05-27-23-54-14-2.jpg.webp",
      "https://i.ibb.co/9kWZFRwB/photo-2025-05-26-17-55-34-2.jpg.webp",
      "https://i.ibb.co/cSqh0Y4b/photo-2025-05-26-17-55-34.jpg.webp",
      "https://i.ibb.co/d4ZCvq9Q/photo-2025-05-26-17-55-35-3.jpg.webp",
      /* …и так далее до 76 URL. */
    ];

    // ================================================
    // Функция создания маленьких карт (76)
    // ================================================
    function createSmallCards(count) {
      disableInteractions();
      // Рандомно перемешаем копию массива bigImages
      const shuffled = bigImages.slice();
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }

      const grid = document.querySelector(".cards-grid");
      grid.innerHTML = "";
      const flippedIndices = loadFlippedIndices();
      const freeCount = flippedIndices.length; // Сколько уже открыто

      for (let i = 0; i < count; i++) {
        const container = document.createElement("div");
        container.classList.add("card-container");

        // Случайная разброска при появлении
        const angle = Math.random() * Math.PI * 2;
        const dist = 50 + Math.random() * 50;
        container.style.transform =
          `scale(0.9) translate(${Math.cos(angle) * dist}px, ${Math.sin(angle) * dist}px)`;

        const smallCard = document.createElement("div");
        smallCard.classList.add("small-card");
        smallCard.dataset.front = shuffled[i];
        smallCard.dataset.index = i; 

        // Устанавливаем рубашку:
        smallCard.style.backgroundImage =
          'url("https://i.ibb.co/wcWxxGp/IMG-8462.webp")';

        // Если карта уже в flippedIndices, сразу показываем лицо
        if (flippedIndices.includes(i)) {
          smallCard.classList.add("flipped");
          smallCard.style.backgroundImage = `url("${smallCard.dataset.front}")`;
        }

        // Блокируем «не перевёрнутые» карты, если freeCount >= FREE_LIMIT
        if (!hasFullAccess() && freeCount >= FREE_LIMIT && !flippedIndices.includes(i)) {
          smallCard.style.pointerEvents = "none";
          smallCard.style.opacity = "0.5";
        }

        smallCard.addEventListener("click", function() {
          if (animationInProgress) return;

          // Если уже full-access, просто открываем оверлей
          if (hasFullAccess()) {
            openOverlay(smallCard.dataset.front);
            return;
          }

          const currentFlipped = loadFlippedIndices();
          // Если этот индекс уже перевёрнут:
          if (currentFlipped.includes(i)) {
            openOverlay(smallCard.dataset.front);
            return;
          }

          // Если достигли лимита бесплатных (5), показываем оплату
          if (currentFlipped.length >= FREE_LIMIT) {
            document.getElementById('paymentOverlay').classList.add('active');
            return;
          }

          // Иначе переворачиваем:
          smallCard.style.backgroundImage = `url("${smallCard.dataset.front}")`;
          smallCard.classList.add("flipped");

          currentFlipped.push(i);
          saveFlippedIndices(currentFlipped);

          // Если теперь после переворота уже 5, затемняем остальные
          if (currentFlipped.length >= FREE_LIMIT) {
            document.querySelectorAll(".cards-grid .small-card").forEach(card => {
              const idx = parseInt(card.dataset.index, 10);
              if (!currentFlipped.includes(idx)) {
                card.style.pointerEvents = "none";
                card.style.opacity = "0.5";
              }
            });
          }

          openOverlay(smallCard.dataset.front);
        });

        container.appendChild(smallCard);
        grid.appendChild(container);

        // Анимация появления
        setTimeout(() => {
          container.classList.add("fade-in");
          container.style.transform = "";
        }, 50);
      }

      setTimeout(enableInteractions, 600);
    }

    // ================================================
    // Открыть большое окно карты (overlay)
    // ================================================
    function openOverlay(imgUrl) {
      if (animationInProgress) return;
      animationInProgress = true;
      const overlay = document.getElementById("overlay");
      overlay.classList.add("active");
      const shuffleIcon = document.getElementById("shuffleIconBtn");
      if (shuffleIcon) shuffleIcon.style.pointerEvents = "none";

      // Убираем префиксы url(“”)
      const chosen = imgUrl.replace(/^url\(["']?/, "").replace(/["']?\)$/, "");
      const bigFront = document.getElementById("bigCardFront");
      bigFront.style.backgroundImage = `url("${chosen}")`;

      // Случайное пожелание
      const dailyWishes = [
        "✨ Нехай цей день принесе тобі світло та натхнення!",
        "💖 Бажаю, щоб емоції були гармонійними, а мрії збувалися!",
        "🌟 Нехай твоя душа знайде відповіді на всі важливі питання!",
        "🌈 Бажаю радості, любові та творчих звершень!",
        "🔥 Нехай кожна мить наповнює тебе енергією та теплом!"
      ];
      const randIdx = Math.floor(Math.random() * dailyWishes.length);
      document.querySelector(".daily-wish").textContent = dailyWishes[randIdx];

      const bigCard = document.getElementById("bigCard");
      bigCard.classList.remove("is-flipped");

      setTimeout(() => {
        animationInProgress = false;
        if (shuffleIcon) shuffleIcon.style.pointerEvents = "auto";
      }, 300);
    }

    document.getElementById("bigCard").addEventListener("click", function(e) {
      if (animationInProgress) return;
      this.classList.toggle("is-flipped");
    });
    document.getElementById("overlay").addEventListener("click", function(e) {
      if (animationInProgress) return;
      if (e.target.id === "overlay") {
        this.classList.remove("active");
        const shuffleIcon = document.getElementById("shuffleIconBtn");
        if (shuffleIcon) shuffleIcon.style.pointerEvents = "auto";
      }
    });

    // ================================================
    // Перетасовать карточки
    // ================================================
    document.getElementById("shuffleIconBtn").addEventListener("click", function() {
      if (animationInProgress) return;
      shuffleCards();
    });
    function shuffleCards() {
      disableInteractions();
      const grid = document.querySelector(".cards-grid");
      const cards = grid.querySelectorAll(".card-container");
      cards.forEach(card => {
        const angle = Math.random() * Math.PI * 2;
        const distance = 50 + Math.random() * 50;
        card.style.transform = `scale(0.9) translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;
        card.style.opacity = "0";
      });
      // Через 0.6с пересоздаём всю сетку
      setTimeout(() => {
        createSmallCards(76);
      }, 600);
    }

    // ================================================
    // Включить/выключить взаимодействие (блокировать все клики)
    // ================================================
    function disableInteractions() {
      animationInProgress = true;
      const grid20 = document.querySelector(".cards-grid");
      if (grid20) grid20.style.pointerEvents = "none";
      const grid72 = document.querySelector(".cards-grid-72");
      if (grid72) grid72.style.pointerEvents = "none";
      const shuffleIcon = document.getElementById("shuffleIconBtn");
      if (shuffleIcon) shuffleIcon.style.pointerEvents = "none";
    }
    function enableInteractions() {
      animationInProgress = false;
      const grid20 = document.querySelector(".cards-grid");
      if (grid20) grid20.style.pointerEvents = "auto";
      const grid72 = document.querySelector(".cards-grid-72");
      if (grid72) grid72.style.pointerEvents = "auto";
      const shuffleIcon = document.getElementById("shuffleIconBtn");
      if (shuffleIcon) shuffleIcon.style.pointerEvents = "auto";
    }

    // ================================================
    // Навигация между секциями
    // ================================================
    function showMainIcons() {
      document.querySelector('.social-left').style.display = 'flex';
      document.querySelector('.social-right').style.display = 'flex';
    }
    function hideMainIcons() {
      document.querySelector('.social-left').style.display = 'none';
      document.querySelector('.social-right').style.display = 'none';
    }
    function openSection(sectionId) {
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('mainFooter').style.display = 'none';
      hideMainIcons();
      document.querySelectorAll('.section').forEach(sec => {
        sec.classList.remove('active');
      });
      document.getElementById(sectionId).classList.add('active');
    }
    function backToMenu() {
      document.querySelectorAll('.section').forEach(sec => {
        sec.classList.remove('active');
      });
      document.getElementById('mainMenu').style.display = 'flex';
      document.getElementById('mainFooter').style.display = 'block';
      showMainIcons();
    }
    function openDeckInfo() {
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('mainFooter').style.display = 'none';
      hideMainIcons();
      document.querySelectorAll('.section').forEach(sec => {
        sec.classList.remove('active');
      });
      document.getElementById('sectionDeckInfo').classList.add('active');
    }
    function continueToDeck() {
      document.getElementById('sectionDeckInfo').classList.remove('active');
      document.getElementById('sectionMakKarti').classList.add('active');
      createSmallCards(76);
    }
    function backToDeckInfo() {
      document.getElementById('sectionMakKarti').classList.remove('active');
      document.getElementById('sectionDeckInfo').classList.add('active');
    }
    function open72Cards() {
      document.getElementById('sectionMakKarti').classList.remove('active');
      document.getElementById('section72Cards').classList.add('active');
      create72Cards();
    }
    function backToMakKartiFrom72() {
      document.getElementById('section72Cards').classList.remove('active');
      document.getElementById('sectionMakKarti').classList.add('active');
    }

    // ================================================
    // Создание секции “72 карт” (если нужно)
    // ================================================
    function create72Cards() {
      disableInteractions();
      const grid = document.querySelector(".cards-grid-72");
      grid.innerHTML = "";
      for (let i = 0; i < 76; i++) {
        const container = document.createElement("div");
        container.classList.add("card-container");
        container.style.opacity = "0";

        const smallCard = document.createElement("div");
        smallCard.classList.add("small-card");

        const front = document.createElement("div");
        front.classList.add("small-card-front");
        if (i < bigImages.length) {
          front.style.backgroundImage = `url("${bigImages[i]}")`;
        } else {
          front.style.background = "rgba(64,224,208,0.2)";
        }

        smallCard.appendChild(front);
        container.appendChild(smallCard);
        grid.appendChild(container);

        setTimeout(() => {
          container.classList.add("fade-in");
          container.style.opacity = "1";
        }, 50);

        smallCard.addEventListener("click", function(e) {
          if (animationInProgress) return;
          const bg = front.style.backgroundImage;
          openOverlay(bg);
        });
      }
      setTimeout(enableInteractions, 600);
    }

    // ================================================
    // Блокнот (modal notes)
    // ================================================
    function openNotes() {
      const dateInput = document.getElementById('notesDate');
      if (!dateInput.value) {
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        dateInput.value = `${yyyy}-${mm}-${dd}`;
      }
      const selDate = dateInput.value;
      const saved = localStorage.getItem('userNotes_' + selDate);
      document.getElementById('notesTextArea').value = saved || "";
      document.getElementById('notesOverlay').classList.add('active');
    }
    function closeNotesModal() {
      let notes = document.getElementById('notesTextArea').value;
      let notesDate = document.getElementById('notesDate').value;
      if (!notesDate) {
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        notesDate = `${yyyy}-${mm}-${dd}`;
      }
      localStorage.setItem('userNotes_' + notesDate, notes);
      document.getElementById('notesOverlay').classList.remove('active');
    }
    document.getElementById('notesOverlay').addEventListener("click", function(e) {
      if (e.target.id === "notesOverlay") {
        closeNotesModal();
      }
    });
  </script>
</body>
</html>
